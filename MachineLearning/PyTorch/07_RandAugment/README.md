# RandAugment

## Abstracts

* Try out RandAugment for image classification task
  * You can read paper [RandAugment: Practical automated data augmentation with a reduced search space](https://arxiv.org/abs/1909.13719)
  * [augmentations.py](./augmentations.py) is from [pytorch-randaugment](https://github.com/ildoonet/pytorch-randaugment/blob/master/RandAugment/augmentations.py)

## Requirements

* Python 3.6 or later
* PyTorch 1.10.2

Please check [requirements.txt](./requirements.txt)

## How to usage?

````cmd
$ python -m pip install -r requirements.txt --extra-index-url https://download.pytorch.org/whl/cu113
````

### Train

You can use own custom dataset.

````cmd
$ python train.py --epoch 30 --batchsize 10 --dataset-rootdir "D:\Dataset\10 Fruits Classification\224" --randaugment --n 9 --m 20
````

### Train

````cmd
$ python convert.py --pretrained trained.pth
2022-11-27 02:09:48,234 [INFO] Arguments
2022-11-27 02:09:48,235 [INFO]                epoch: 30
2022-11-27 02:09:48,236 [INFO]            batchsize: 10
2022-11-27 02:09:48,237 [INFO]      dataset_rootdir: D:\Dataset\10 Fruits Classification\224
2022-11-27 02:09:48,237 [INFO]   tensorboard_logdir: None
2022-11-27 02:09:48,238 [INFO]          randaugment: True
2022-11-27 02:09:48,239 [INFO]                    n: 9
2022-11-27 02:09:48,239 [INFO]                    m: 20
2022-11-27 02:09:49,386 [INFO] Start Training
[Epoch 1/30]: 100%|█████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:57<00:00,  3.47it/s, Loss=0.175] 
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 11.86it/s, Accuracy=0.872] 
2022-11-27 02:10:51,240 [INFO] Update Best Accuracy: from 0.0 to 0.872
[Epoch 2/30]: 100%|█████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:55<00:00,  3.62it/s, Loss=0.116]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 12.09it/s, Accuracy=0.878] 
2022-11-27 02:11:51,581 [INFO] Update Best Accuracy: from 0.872 to 0.878
[Epoch 3/30]: 100%|████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:55<00:00,  3.61it/s, Loss=0.0997]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 12.04it/s, Accuracy=0.928] 
2022-11-27 02:12:52,119 [INFO] Update Best Accuracy: from 0.878 to 0.928
[Epoch 4/30]: 100%|████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:55<00:00,  3.61it/s, Loss=0.0952]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 12.05it/s, Accuracy=0.948] 
2022-11-27 02:13:52,666 [INFO] Update Best Accuracy: from 0.928 to 0.948
[Epoch 5/30]: 100%|████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:55<00:00,  3.62it/s, Loss=0.0887]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 12.01it/s, Accuracy=0.944] 
[Epoch 6/30]: 100%|████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:54<00:00,  3.65it/s, Loss=0.0869] 
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 11.99it/s, Accuracy=0.914] 
[Epoch 7/30]: 100%|████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:54<00:00,  3.68it/s, Loss=0.0888] 
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 12.08it/s, Accuracy=0.972] 
2022-11-27 02:16:50,601 [INFO] Update Best Accuracy: from 0.948 to 0.972
[Epoch 8/30]: 100%|████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:55<00:00,  3.61it/s, Loss=0.0918]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 11.94it/s, Accuracy=0.966] 
[Epoch 9/30]: 100%|████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:54<00:00,  3.67it/s, Loss=0.0889] 
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 11.95it/s, Accuracy=0.962] 
[Epoch 10/30]: 100%|███████████████████████████████████████████████████████████████████████████████████| 200/200 [00:54<00:00,  3.65it/s, Loss=0.0933] 
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 11.99it/s, Accuracy=0.94] 
[Epoch 11/30]: 100%|███████████████████████████████████████████████████████████████████████████████████| 200/200 [00:54<00:00,  3.65it/s, Loss=0.0856] 
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 11.96it/s, Accuracy=0.974] 
2022-11-27 02:20:47,847 [INFO] Update Best Accuracy: from 0.972 to 0.974
[Epoch 12/30]: 100%|███████████████████████████████████████████████████████████████████████████████████| 200/200 [00:55<00:00,  3.63it/s, Loss=0.0937]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 12.04it/s, Accuracy=0.946] 
[Epoch 13/30]: 100%|███████████████████████████████████████████████████████████████████████████████████| 200/200 [00:54<00:00,  3.65it/s, Loss=0.0962] 
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 11.95it/s, Accuracy=0.894] 
[Epoch 14/30]: 100%|████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:55<00:00,  3.62it/s, Loss=0.103] 
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 12.00it/s, Accuracy=0.95] 
[Epoch 15/30]: 100%|███████████████████████████████████████████████████████████████████████████████████| 200/200 [00:54<00:00,  3.64it/s, Loss=0.0951] 
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 12.05it/s, Accuracy=0.896] 
[Epoch 16/30]: 100%|████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:54<00:00,  3.64it/s, Loss=0.102] 
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 11.94it/s, Accuracy=0.936] 
[Epoch 17/30]: 100%|████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:54<00:00,  3.64it/s, Loss=0.102] 
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 11.99it/s, Accuracy=0.956] 
[Epoch 18/30]: 100%|████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:54<00:00,  3.64it/s, Loss=0.103] 
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 12.04it/s, Accuracy=0.958] 
[Epoch 19/30]: 100%|████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:54<00:00,  3.65it/s, Loss=0.113] 
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 12.03it/s, Accuracy=0.816] 
[Epoch 20/30]: 100%|████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:54<00:00,  3.66it/s, Loss=0.114] 
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 12.18it/s, Accuracy=0.928] 
[Epoch 21/30]: 100%|████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:54<00:00,  3.66it/s, Loss=0.114] 
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 12.22it/s, Accuracy=0.95] 
[Epoch 22/30]: 100%|████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:54<00:00,  3.67it/s, Loss=0.117] 
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 12.03it/s, Accuracy=0.906] 
[Epoch 23/30]: 100%|█████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:54<00:00,  3.65it/s, Loss=0.11] 
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 11.94it/s, Accuracy=0.862] 
[Epoch 24/30]: 100%|████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:55<00:00,  3.61it/s, Loss=0.113] 
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 12.01it/s, Accuracy=0.916] 
[Epoch 25/30]: 100%|████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:54<00:00,  3.66it/s, Loss=0.115] 
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 12.13it/s, Accuracy=0.846] 
[Epoch 26/30]: 100%|████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:54<00:00,  3.64it/s, Loss=0.113] 
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 11.88it/s, Accuracy=0.84] 
[Epoch 27/30]: 100%|████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:55<00:00,  3.63it/s, Loss=0.124] 
100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 12.04it/s, Accuracy=0.9] 
[Epoch 28/30]: 100%|████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:54<00:00,  3.65it/s, Loss=0.117] 
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 12.07it/s, Accuracy=0.86] 
[Epoch 29/30]: 100%|█████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:54<00:00,  3.65it/s, Loss=0.12] 
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 11.93it/s, Accuracy=0.86] 
[Epoch 30/30]: 100%|████████████████████████████████████████████████████████████████████████████████████| 200/200 [00:54<00:00,  3.66it/s, Loss=0.115] 
100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 50/50 [00:04<00:00, 12.06it/s, Accuracy=0.858] 
````